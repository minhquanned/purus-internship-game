import { EventHandler } from '../core/event-handler.js';

class Render extends EventHandler {
	constructor(...args) {
		super(...args);
		this._meshes = null;
	}
	set meshes(value) {
		this.decRefMeshes();
		this._meshes = value;
		this.incRefMeshes();
		this.fire('set:meshes', value);
	}
	get meshes() {
		return this._meshes;
	}
	destroy() {
		this.meshes = null;
	}
	decRefMeshes() {
		var _this$_meshes;
		(_this$_meshes = this._meshes) == null || _this$_meshes.forEach((mesh, index) => {
			if (mesh) {
				mesh.decRefCount();
				if (mesh.refCount < 1) {
					mesh.destroy();
					this._meshes[index] = null;
				}
			}
		});
	}
	incRefMeshes() {
		var _this$_meshes2;
		(_this$_meshes2 = this._meshes) == null || _this$_meshes2.forEach(mesh => {
			mesh == null || mesh.incRefCount();
		});
	}
}
Render.EVENT_SETMESHES = 'set:meshes';

export { Render };
